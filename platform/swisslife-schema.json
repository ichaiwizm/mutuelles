{
  "schema_version": "1.0.0",
  "description": "Schéma complet des champs SwissLife pour le remplissage automatique de formulaires",
  "last_updated": "2025-08-20",
  
  "fields": {
    "projectName": {
      "label": "Nom du projet",
      "type": "text",
      "required": true,
      "description": "Nom de la simulation",
      "template": "Simulation {{lead.nom}} {{lead.prenom}}",
      "validation": {
        "maxLength": 100
      }
    },
    
    "hospitalComfort": {
      "label": "Confort Hospitalisation",
      "type": "radio",
      "required": true,
      "description": "Indemnités journalières d'hospitalisation",
      "options": [
        { "value": "oui", "label": "Oui" },
        { "value": "non", "label": "Non" }
      ],
      "default": "non"
    },
    
    "simulationType": {
      "label": "Type de simulation",
      "type": "radio",
      "required": true,
      "description": "Type de contrat (individuel ou couple)",
      "options": [
        { "value": "individuel", "label": "Individuel", "aliases": ["indiv"] },
        { "value": "couple", "label": "Couple" }
      ],
      "rules": {
        "autoDetect": "Si conjoint présent dans lead, sélectionner 'couple'"
      }
    },
    
    "souscripteur": {
      "label": "Informations Souscripteur",
      "type": "object",
      "required": true,
      "fields": {
        "dateNaissance": {
          "label": "Date de naissance",
          "type": "date",
          "required": true,
          "format": "DD/MM/YYYY",
          "validation": {
            "minAge": 18,
            "maxAge": 85
          }
        },
        "regimeSocial": {
          "label": "Régime social",
          "type": "select",
          "required": true,
          "options": [
            { "value": "SECURITE_SOCIALE", "label": "Régime Général (CPAM)" },
            { "value": "SECURITE_SOCIALE_ALSACE_MOSELLE", "label": "Régime Local (CPAM Alsace Moselle)" },
            { "value": "TNS", "label": "Régime Général pour TNS (CPAM)" },
            { "value": "AMEXA", "label": "Mutualité Sociale Agricole (MSA-Amexa)" },
            { "value": "AUTRES_REGIME_SPECIAUX", "label": "Autres régimes spéciaux" }
          ]
        },
        "statut": {
          "label": "Statut professionnel",
          "type": "select",
          "required": true,
          "dependsOn": "regimeSocial",
          "options": {
            "SECURITE_SOCIALE": [
              { "value": "SALARIE", "label": "Salarié et autres statuts" },
              { "value": "ETUDIANT", "label": "Etudiant" },
              { "value": "RETRAITE", "label": "Retraité" },
              { "value": "TRAVAILLEUR_TRANSFRONTALIER", "label": "Travailleur transfrontalier" }
            ],
            "SECURITE_SOCIALE_ALSACE_MOSELLE": [
              { "value": "SALARIE", "label": "Salarié et autres statuts" },
              { "value": "ETUDIANT", "label": "Etudiant" },
              { "value": "RETRAITE", "label": "Retraité" },
              { "value": "TRAVAILLEUR_TRANSFRONTALIER", "label": "Travailleur transfrontalier" }
            ],
            "TNS": [
              { "value": "TNS", "label": "Travailleur Non Salarié" }
            ],
            "AMEXA": [
              { "value": "SALARIE_AGRICOLE", "label": "Salarié agricole et autres statuts" },
              { "value": "EXPLOITANT_AGRICOLE", "label": "Exploitant agricole" },
              { "value": "RETRAITE_ANCIEN_SALARIE", "label": "Retraité (ancien salarié)" },
              { "value": "RETRAITE_ANCIEN_EXPLOITANT", "label": "Retraité (ancien exploitant)" }
            ],
            "AUTRES_REGIME_SPECIAUX": [
              { "value": "FONCTIONNAIRE", "label": "Fonctionnaire" },
              { "value": "SALARIE", "label": "Salarié et autres statuts" },
              { "value": "ETUDIANT", "label": "Etudiant" },
              { "value": "RETRAITE", "label": "Retraité" }
            ]
          }
        },
        "profession": {
          "label": "Profession",
          "type": "select",
          "required": true,
          "dependsOn": ["regimeSocial", "statut"],
          "options": {
            "TNS": [
              { "value": "MEDECIN", "label": "Médecin" },
              { "value": "CHIRURGIEN", "label": "Chirurgien" },
              { "value": "CHIRURGIEN_DENTISTE", "label": "Chirurgien dentiste" },
              { "value": "PHARMACIEN", "label": "Pharmacien" },
              { "value": "AUXILIAIRE_MEDICAL", "label": "Auxiliaire médical" },
              { "value": "AUTRE", "label": "Non médicale" }
            ],
            "default": [
              { "value": "AUTRE", "label": "Non applicable" }
            ]
          }
        },
        "departement": {
          "label": "Département",
          "type": "select",
          "required": true,
          "description": "Code postal du département",
          "validation": {
            "pattern": "^[0-9]{2,3}$"
          }
        }
      }
    },
    
    "conjoint": {
      "label": "Informations Conjoint",
      "type": "object",
      "required": false,
      "condition": "simulationType === 'couple'",
      "fields": {
        "dateNaissance": {
          "label": "Date de naissance",
          "type": "date",
          "required": true,
          "format": "DD/MM/YYYY",
          "validation": {
            "minAge": 18,
            "maxAge": 85
          }
        },
        "regimeSocial": {
          "label": "Régime social",
          "type": "select",
          "required": true,
          "options": [
            { "value": "SECURITE_SOCIALE", "label": "Régime Général (CPAM)" },
            { "value": "SECURITE_SOCIALE_ALSACE_MOSELLE", "label": "Régime Local (CPAM Alsace Moselle)" },
            { "value": "TNS", "label": "Régime Général pour TNS (CPAM)" },
            { "value": "AMEXA", "label": "Mutualité Sociale Agricole (MSA-Amexa)" },
            { "value": "AUTRES_REGIME_SPECIAUX", "label": "Autres régimes spéciaux" }
          ]
        },
        "statut": {
          "label": "Statut professionnel",
          "type": "select",
          "required": true,
          "dependsOn": "regimeSocial",
          "options": {
            "SECURITE_SOCIALE": [
              { "value": "SALARIE", "label": "Salarié et autres statuts" },
              { "value": "ETUDIANT", "label": "Etudiant" },
              { "value": "RETRAITE", "label": "Retraité" },
              { "value": "TRAVAILLEUR_TRANSFRONTALIER", "label": "Travailleur transfrontalier" }
            ],
            "SECURITE_SOCIALE_ALSACE_MOSELLE": [
              { "value": "SALARIE", "label": "Salarié et autres statuts" },
              { "value": "ETUDIANT", "label": "Etudiant" },
              { "value": "RETRAITE", "label": "Retraité" },
              { "value": "TRAVAILLEUR_TRANSFRONTALIER", "label": "Travailleur transfrontalier" }
            ],
            "TNS": [
              { "value": "TNS", "label": "Travailleur Non Salarié" }
            ],
            "AMEXA": [
              { "value": "SALARIE_AGRICOLE", "label": "Salarié agricole et autres statuts" },
              { "value": "EXPLOITANT_AGRICOLE", "label": "Exploitant agricole" },
              { "value": "RETRAITE_ANCIEN_SALARIE", "label": "Retraité (ancien salarié)" },
              { "value": "RETRAITE_ANCIEN_EXPLOITANT", "label": "Retraité (ancien exploitant)" }
            ],
            "AUTRES_REGIME_SPECIAUX": [
              { "value": "FONCTIONNAIRE", "label": "Fonctionnaire" },
              { "value": "SALARIE", "label": "Salarié et autres statuts" },
              { "value": "ETUDIANT", "label": "Etudiant" },
              { "value": "RETRAITE", "label": "Retraité" }
            ]
          }
        },
        "profession": {
          "label": "Profession",
          "type": "select",
          "required": true,
          "dependsOn": ["regimeSocial", "statut"],
          "options": {
            "TNS": [
              { "value": "MEDECIN", "label": "Médecin" },
              { "value": "CHIRURGIEN", "label": "Chirurgien" },
              { "value": "CHIRURGIEN_DENTISTE", "label": "Chirurgien dentiste" },
              { "value": "PHARMACIEN", "label": "Pharmacien" },
              { "value": "AUXILIAIRE_MEDICAL", "label": "Auxiliaire médical" },
              { "value": "AUTRE", "label": "Non médicale" }
            ],
            "default": [
              { "value": "AUTRE", "label": "Non applicable" }
            ]
          }
        },
        "departement": {
          "label": "Département",
          "type": "select",
          "required": true,
          "description": "Code postal du département",
          "validation": {
            "pattern": "^[0-9]{2,3}$"
          }
        }
      }
    },
    
    "enfants": {
      "label": "Informations Enfants",
      "type": "array",
      "required": false,
      "maxItems": 4,
      "itemSchema": {
        "dateNaissance": {
          "label": "Date de naissance",
          "type": "date",
          "required": true,
          "format": "DD/MM/YYYY",
          "validation": {
            "maxAge": 25,
            "notInFuture": true
          }
        },
        "ayantDroit": {
          "label": "Ayant droit",
          "type": "select",
          "required": false,
          "condition": "simulationType === 'couple'",
          "options": [
            { "value": "souscripteur", "label": "Souscripteur" },
            { "value": "conjoint", "label": "Conjoint" }
          ],
          "default": "souscripteur"
        }
      }
    },
    
    "gammes": {
      "label": "Gamme d'assurance",
      "type": "select",
      "required": true,
      "options": [
        { "value": "SwissLife Santé", "label": "SwissLife Santé" }
      ],
      "default": "SwissLife Santé"
    },
    
    "options": {
      "label": "Options du contrat",
      "type": "object",
      "required": false,
      "fields": {
        "madelin": {
          "label": "Option Madelin",
          "type": "checkbox",
          "required": false,
          "description": "Contrat Madelin (déductible fiscalement)",
          "options": [
            { "value": "oui", "label": "Oui", "aliases": ["true", "1"] },
            { "value": "non", "label": "Non", "aliases": ["false", "0"] }
          ],
          "default": "oui"
        },
        "resiliation": {
          "label": "Résiliation contrat actuel",
          "type": "radio",
          "required": false,
          "description": "Résiliation d'un contrat existant",
          "options": [
            { "value": "oui", "label": "Oui" },
            { "value": "non", "label": "Non" }
          ],
          "default": "non"
        },
        "reprise": {
          "label": "Reprise d'ancienneté",
          "type": "radio",
          "required": false,
          "description": "Reprise de l'ancienneté du contrat précédent",
          "options": [
            { "value": "oui", "label": "Oui" },
            { "value": "non", "label": "Non" }
          ],
          "default": "non",
          "rules": {
            "dependency": "Si reprise === 'oui', alors resiliation === 'oui'"
          }
        }
      }
    },
    
    "dateEffet": {
      "label": "Date d'effet du contrat",
      "type": "date",
      "required": true,
      "format": "DD/MM/YYYY",
      "description": "Date de début du contrat",
      "validation": {
        "minDate": "today",
        "maxDate": "+6months"
      },
      "specialValues": {
        "today": "Date du jour",
        "aujourd'hui": "Date du jour"
      }
    }
  },
  
  "workflow": {
    "steps": [
      {
        "order": 1,
        "id": "projectName",
        "label": "Nom du projet",
        "service": "nom-projet-service",
        "required": true
      },
      {
        "order": 2,
        "id": "hospitalComfort",
        "label": "Confort hospitalisation",
        "service": "confort-hospitalisation-service",
        "required": true
      },
      {
        "order": 3,
        "id": "simulationType",
        "label": "Type de simulation",
        "service": "simulation-type-service",
        "required": true
      },
      {
        "order": 4,
        "id": "subscriberInfo",
        "label": "Informations souscripteur",
        "service": "souscripteur-service",
        "required": true
      },
      {
        "order": 5,
        "id": "spouseInfo",
        "label": "Informations conjoint",
        "service": "conjoint-service",
        "condition": "simulationType === 'couple'",
        "required": false
      },
      {
        "order": 6,
        "id": "childrenInfo",
        "label": "Informations enfants",
        "service": "enfants-service",
        "condition": "nombreEnfants > 0",
        "required": false
      },
      {
        "order": 7,
        "id": "gammes",
        "label": "Sélection gamme",
        "service": "gammes-service",
        "required": true
      },
      {
        "order": 8,
        "id": "options",
        "label": "Options du contrat",
        "service": "options-service",
        "required": false
      },
      {
        "order": 9,
        "id": "dateEffet",
        "label": "Date d'effet",
        "service": "date-effet-service",
        "required": true
      },
      {
        "order": 10,
        "id": "navigation",
        "label": "Navigation",
        "service": "navigation-service",
        "type": "action",
        "required": true
      }
    ]
  },
  
  "mappings": {
    "leadToSwissLife": {
      "regimeSocial": {
        "TNS : régime des indépendants": "TNS",
        "Salarié (ou retraité)": "SECURITE_SOCIALE",
        "TNS": "TNS",
        "Salarié": "SECURITE_SOCIALE",
        "Etudiant": "SECURITE_SOCIALE",
        "Retraité": "SECURITE_SOCIALE",
        "Fonctionnaire": "AUTRES_REGIME_SPECIAUX",
        "Exploitant agricole": "AMEXA",
        "Salarié agricole": "AMEXA",
        "Régime Local Alsace-Moselle": "SECURITE_SOCIALE_ALSACE_MOSELLE"
      },
      "statut": {
        "Chef d'entreprise": "TNS",
        "En recherche d'emploi": "SALARIE",
        "Salarié": "SALARIE",
        "Retraité": "RETRAITE",
        "Etudiant": "ETUDIANT",
        "Fonctionnaire": "FONCTIONNAIRE",
        "Travailleur transfrontalier": "TRAVAILLEUR_TRANSFRONTALIER",
        "Exploitant agricole": "EXPLOITANT_AGRICOLE",
        "Salarié agricole": "SALARIE_AGRICOLE",
        "TNS": "TNS"
      },
      "profession": {
        "Médecin": "MEDECIN",
        "Chirurgien": "CHIRURGIEN",
        "Chirurgien dentiste": "CHIRURGIEN_DENTISTE",
        "Dentiste": "CHIRURGIEN_DENTISTE",
        "Pharmacien": "PHARMACIEN",
        "Infirmier": "AUXILIAIRE_MEDICAL",
        "Kinésithérapeute": "AUXILIAIRE_MEDICAL",
        "Autre": "AUTRE",
        "Non médicale": "AUTRE",
        "Chef d'entreprise": "AUTRE",
        "En recherche d'emploi": "AUTRE",
        "Salarié": "AUTRE",
        "Retraité": "AUTRE",
        "Etudiant": "AUTRE"
      }
    }
  },
  
  "validation": {
    "rules": [
      {
        "field": "conjoint",
        "condition": "simulationType === 'couple'",
        "required": true,
        "message": "Les informations du conjoint sont requises pour une simulation couple"
      },
      {
        "field": "options.madelin",
        "visible": true,
        "message": "L'option Madelin est disponible pour tous les profils"
      },
      {
        "field": "options.reprise",
        "dependency": "options.resiliation",
        "rule": "Si reprise === 'oui', alors resiliation doit être 'oui'",
        "autoSet": true
      },
      {
        "field": "enfants",
        "maxCount": 4,
        "message": "Maximum 4 enfants supportés"
      }
    ]
  },
  
  "errorCodes": {
    "NOT_FOUND": "Élément non trouvé dans le DOM",
    "HIDDEN": "Élément masqué ou non visible",
    "DISABLED": "Élément désactivé",
    "VALUE_MISMATCH": "Valeur non compatible avec les options disponibles",
    "VALIDATION_ERROR": "Erreur de validation du formulaire",
    "FILL_ERROR": "Erreur lors du remplissage du champ",
    "READ_ERROR": "Erreur lors de la lecture du champ",
    "TIMEOUT": "Délai d'attente dépassé",
    "WORKFLOW_ERROR": "Erreur dans le workflow d'exécution"
  },
  
  "leadStructure": {
    "description": "Structure complète d'un lead pour SwissLife",
    "example": {
      "id": "lead-001",
      "contact": {
        "civilite": "M.",
        "nom": "DESCHAMPS",
        "prenom": "BAPTISTE",
        "telephone": "06.99.79.67.14",
        "email": "baptiste.deschamps@hotmail.fr",
        "adresse": "2 RUE DEBRAY",
        "codePostal": "44300",
        "ville": "NANTES"
      },
      "souscripteur": {
        "dateNaissance": "02/06/1991",
        "profession": "Chef d'entreprise",
        "regimeSocial": "TNS : régime des indépendants",
        "nombreEnfants": 3
      },
      "conjoint": {
        "dateNaissance": "11/09/1992",
        "profession": "En recherche d'emploi",
        "regimeSocial": "Salarié (ou retraité)"
      },
      "enfants": [
        {
          "dateNaissance": "14/03/2019"
        },
        {
          "dateNaissance": "05/05/2021"
        },
        {
          "dateNaissance": "08/08/2024"
        }
      ],
      "besoins": {
        "dateEffet": "07/04/2025",
        "assureActuellement": false,
        "niveaux": {
          "soinsMedicaux": 3,
          "hospitalisation": 3,
          "optique": 3,
          "dentaire": 3
        }
      },
      "signature": {
        "numeroOrias": "12345678",
        "siren": "123456789",
        "siteWeb": "www.example.com",
        "instagram": "@example",
        "numeroRCP": "RCP123456",
        "nomEntreprise": "Example SARL"
      }
    }
  }
}